<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Ventas Outbound</title>
    <style>
        body {
            font-family: Barlow, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            flex-direction: column;
        }

        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 1000px;
        }

        h2 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
        }

        .form-grid {
    		display: grid;
    		grid-template-columns: repeat(3, 1fr);
    		gap: 15px; /* Espaciado entre filas y columnas */
   		 column-gap: 25px; /* Aumenta el espacio entre columnas */
	}

        label {
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
        }

        input, select {
    		width: 100%;
   		padding: 10px;
    		border: 1px solid #ccc;
    		border-radius: 5px;
    		font-size: 15px; /* Unifica el tamaño del texto */
    		height: 40px; /* Asegura una altura uniforme */
    		box-sizing: border-box; /* Evita que el padding afecte el tamaño total */
	}

        .button-container {
            display: flex;
            justify-content: center;
            gap: 15px; /* Espaciado entre los botones */
            margin-top: 20px;
        }

        button {
            font-family: 'Barlow', sans-serif;
            font-size: 17px;
            padding: 10px;
            border: none;
            border-radius: 7px;
            cursor: pointer;
            width: 150px; /* Asegura un tamaño uniforme */
        }

        #enviarBtn {
    		background-color: #00EEB0;
    		color: black;
    		font-weight: bold;
	}

        #enviarBtn:hover {
            background-color: #00CC97;
        }

        #limpiarBtn {
            background-color: #FF0000;
            color: white;
        }

        #limpiarBtn:hover {
            background-color: #c82333;
        }

        @media (max-width: 800px) {
            .form-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 500px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>

</head>
<body>

    <h2>Registro de Ventas Outbound</h2>

    <div class="container">
        <form id="salesForm">
            <div class="form-grid">
                <div>
                    <label>Fecha de Venta:</label>
                    <input type="date" id="FechaVenta" required>
                </div>

                <div>
                    <label>DNI:</label>
                    <input type="text" id="DNI" placeholder="Ej: 12345678" required>
                </div>

                <div>
                    <label>Nombre Ejecutivo:</label>
                    <input type="text" id="NombreEjecutivo" placeholder="Ej: Juan Perez" required>
                </div>

                <div>
                    <label>Usuario OneTouch:</label>
                    <input type="text" id="UsuarioOneTouch" placeholder="Usuario AAP_" required>
                </div>

                <div>
                    <label>Habilidad:</label>
                    <select id="Habilidad" required>
			<option value="" disabled selected>Selecciona tu opción</option>
                        <option value="FibraClientes">Fibra Clientes</option>
                        <option value="Fibra NoClientes">Fibra No Clientes</option>
                        <option value="Convergente">Convegente</option>
                    </select>
                </div>

		<div>
   		 <label>Producto:</label>
    		<select id="Producto" required>
    		    <option value="" disabled selected>Selecciona tu opción</option>
   		 </select>
		</div>

    
                <div>
                    <label>RUT Cliente:</label>
                    <input type="text" id="RUTCliente" placeholder="Ej: 12345678-9" required>
                </div>

           	<div>
                    <label>Nombre Cliente:</label>
                    <input type="text" id="NombreCliente" placeholder="Ej: Pedro Gomez">
                </div>


                <div>
                    <label>Dirección Cliente:</label>
                    <input type="text" id="DireccionCliente" placeholder="Ej: Av. Principal 1234">
                </div>

		<div>
    			<label>Región:</label>
    			<select id="Region" required>
        		<option value="" disabled selected>Selecciona una región</option>
    			</select>
		</div>

		<div>
    			<label>Comuna:</label>
    			<select id="Comuna" required>
        		<option value="" disabled selected>Selecciona una comuna</option>
    			</select>
		</div>


 		<div>
   		 <label>Plan Tarifario:</label>
   		 <select id="PlanTarifario" required>
       		 <option value="" disabled selected>Selecciona tu opción</option>
  		 </select>
		</div>

                <div>
                    <label>Numero de Grabacion:</label>
                    <input type="text" id="Movil1" placeholder="Ej: 56912345678" required>
                </div>

                <div>
                    <label>Contacto Adicional:</label>
                    <input type="text" id="Movil2" placeholder="Opcional">
                </div>

		<div>
    			<label>Portabilidad:</label>
   			 <select id="Portabilidad" required>
        			<option value="" disabled selected>Selecciona tu opción</option>
    			</select>
		</div>

		<div>
    		<label>Compañía Donadora:</label>
    		<select id="CompaniaDonadora" required>
        		<option value="" disabled selected>Selecciona tu opción</option>
    		</select>
		</div>


                <div>
                    <label>Fecha de Instalación:</label>
                    <input type="date" id="FechaInstalacion">
                </div>

    
            <div>
                    <label>Numero de Negocio:</label>
                    <input type="text" id="NumNegocio" placeholder="Numero de negocio" required>
                </div>




            </div>
            <div class="button-container">
                <button type="submit" id="enviarBtn">Enviar</button>
                <button type="button" id="limpiarBtn">Limpiar</button>
            </div>
        </form>

        <p id="respuesta" style="text-align: center; font-weight: bold; color: red;"></p>
    </div>



<script>
    document.getElementById("salesForm").addEventListener("submit", function(event) {
        event.preventDefault();

        var data = {
            FechaVenta: document.getElementById("FechaVenta").value,
            DNI: document.getElementById("DNI").value,
            NombreEjecutivo: document.getElementById("NombreEjecutivo").value,
            UsuarioOneTouch: document.getElementById("UsuarioOneTouch").value,
            RUTCliente: document.getElementById("RUTCliente").value,
            NumNegocio: document.getElementById("NumNegocio").value,
            Movil1: document.getElementById("Movil1").value,
            Movil2: document.getElementById("Movil2").value,
            Habilidad: document.getElementById("Habilidad").value,
            Producto: document.getElementById("Producto").value,
            PlanTarifario: document.getElementById("PlanTarifario").value,
            Comuna: document.getElementById("Comuna").value,
            Region: document.getElementById("Region").value,
            NombreCliente: document.getElementById("NombreCliente").value,
            DireccionCliente: document.getElementById("DireccionCliente").value,
            Portabilidad: document.getElementById("Portabilidad").value,
            CompaniaDonadora: document.getElementById("CompaniaDonadora").value,
            FechaInstalacion: document.getElementById("FechaInstalacion").value
        };

        let scriptURL = "https://script.google.com/macros/s/AKfycbx2odxLV10HJIQx4dSWRWCYzSsWWSP7IHZug4qXCAmvf4LqNxkmWzGAormnE4kxrFZ4XQ/exec"; // Reemplaza con tu enlace de Google Apps Script

        fetch(scriptURL, {
            method: "POST",
            mode: "no-cors",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
        })
        .then(() => {
            document.getElementById("respuesta").innerText = "Datos enviados con éxito";
            document.getElementById("salesForm").reset();
        })
        .catch(error => {
            document.getElementById("respuesta").innerText = "Error al enviar los datos";
        });
    });
	document.getElementById("limpiarBtn").addEventListener("click", function() {
        document.getElementById("salesForm").reset();
        document.getElementById("respuesta").innerText = "¡Campos Limpios!";
        setTimeout(() => { document.getElementById("respuesta").innerText = ""; }, 3000);
    });


// Regiones y comunas de Chile
const regionesYComunas = {

    "Metropolitana de Santiago": ["Buin", "Calera De Tango", "Cerrillos", "Cerro Navia", "Colina", "Conchali", "El Bosque", "El Monte", "Estacion Central", 	"Huechuraba", "Independencia", "Isla De Maipo", "La Cisterna", "La Florida", "La Granja", "La Reina", "Lampa", "Las Condes", "Lo Barnechea", "Lo Espejo", "Lo 	Prado", "Macul", "Maipu", "Melipilla", "Nunoa", "Padre Hurtado", "Paine", "Pedro Aguirre Cerda", "Penaflor", "Penalolen", "Pirque", "Providencia", 	"Pudahuel", "Puente Alto", "Quilicura", "Quinta Normal", "Recoleta", "Renca", "San Bernardo", "San Joaquin", "San Jose De Maipo", "San Miguel", "San Ramon", 	"Santiago", "Talagante", "Vitacura"],

    "Antofagasta": ["Antofagasta", "Calama", "San Pedro De Atacama", "Tocopilla"],
    "Arica & Parinacota": ["Arica"],
    "Atacama": ["Copiapo", "Vallenar"],
    "Biobio": ["Arauco", "Bio Bio", "Canete", "Chiguayante", "Chillan", "Chillan Viejo", "Concepcion", "Coronel", "Florida", "Hualpen", "Hualqui", "Los Angeles", 	"Niquen", "Nuble", "Penco", "San Carlos", "San Pedro De La Paz", "Talcahuano", "Tome"],
    "Coquimbo": ["Coquimbo", "Illapel", "La Serena", "Los Vilos", "Ovalle"],
    "La Araucania": ["Araucania", "Lautaro", "Padre Las Casas", "Temuco", "Villarrica"],
    "Los Rios": ["La Union", "Los Lagos", "Valdivia"],
    "Los Lagos": ["Osorno", "Puerto Montt", "Puerto Varas"],
    "Libertador Bernardo O'Higgins": ["Coltauco", "Graneros", "Machali", "Mostazal", "Ohiggins", "Pichilemu", "Rancagua", "Rengo", "San Fernando", "Santa Cruz"],
    "Maule": ["Constitucion", "Curico", "Linares", "Maule", "Molina", "Parral", "San Javier", "Talca"],
    "Tarapaca": ["Alto Hospicio", "Iquique"],
    "Valparaiso": ["Algarrobo", "Calera", "Calle Larga", "Casablanca", "Catemu", "Concon", "El Tabo", "Hijuelas", "La Cruz", "La Ligua", "Limache", "Llaillay", "Los 	Andes", "Nogales", "Olmue", "Panquehue", "Papudo", "Quillota", "Quilpue", "Quintero", "Rinconada", "San Antonio", "San Esteban", "San Felipe", "Santa Maria", 	"Santo Domingo", "Valparaiso", "Villa Alemana", "Vina Del Mar", "Zapallar"]

};

// Llenar el select de regiones
const regionSelect = document.getElementById("Region");
const comunaSelect = document.getElementById("Comuna");

for (let region in regionesYComunas) {
    const option = document.createElement("option");
    option.value = region;
    option.text = region;
    regionSelect.appendChild(option);
}

// Actualizar comunas según la región seleccionada
regionSelect.addEventListener("change", function () {
    const comunas = regionesYComunas[this.value] || [];
    comunaSelect.innerHTML = '<option value="" disabled selected>Selecciona una comuna</option>'; // Reset

    comunas.forEach(comuna => {
        const option = document.createElement("option");
        option.value = comuna;
        option.text = comuna;
        comunaSelect.appendChild(option);
    });
});


// Opciones de Portabilidad y Compañía Donadora
const portabilidadYCompania = {
    "Si": ["Movistar", "Claro", "Wom", "Gtd", "Pacifico", "Otro"],
    "No": ["-"]
};

// Llenar el select de Portabilidad
const portabilidadSelect = document.getElementById("Portabilidad");
const companiaDonadoraSelect = document.getElementById("CompaniaDonadora");

for (let portabilidad in portabilidadYCompania) {
    const option = document.createElement("option");
    option.value = portabilidad;
    option.text = portabilidad;
    portabilidadSelect.appendChild(option);
}

// Actualizar el select de Compañía Donadora según la opción de Portabilidad
portabilidadSelect.addEventListener("change", function () {
    const companias = portabilidadYCompania[this.value] || [];
    companiaDonadoraSelect.innerHTML = '<option value="" disabled selected>Selecciona tu opción</option>'; // Reset

    companias.forEach(compania => {
        const option = document.createElement("option");
        option.value = compania;
        option.text = compania;
        companiaDonadoraSelect.appendChild(option);
    });
});


// Opciones de Producto y sus Planes Tarifarios correspondientes
const productoYPlanes = {
    "Fibra": [
        "Internet 600", "Internet 800", "Internet 940",
        "TVFull 600", "TVFull 800", "TVFull 940",
        "TVLite 600", "TVLite 800", "TVLite 940",
        "TrioFull 600", "TrioFull 800", "TrioFull 940",
        "TrioLite 600", "TrioLite 800", "TrioLite 940"
    ],
    "Movil": ["Portabilidad","Linea Nueva","Linea Adicional","Migracion"]
};

// Obtener los selectores
const productoSelect = document.getElementById("Producto");
const planTarifarioSelect = document.getElementById("PlanTarifario");

// Llenar el select de Producto
for (let producto in productoYPlanes) {
    const option = document.createElement("option");
    option.value = producto;
    option.text = producto;
    productoSelect.appendChild(option);
}

// Actualizar el select de Plan Tarifario según la opción de Producto
productoSelect.addEventListener("change", function () {
    const planes = productoYPlanes[this.value] || [];
    planTarifarioSelect.innerHTML = '<option value="" disabled selected>Selecciona tu opción</option>'; // Reset

    planes.forEach(plan => {
        const option = document.createElement("option");
        option.value = plan;
        option.text = plan;
        planTarifarioSelect.appendChild(option);
    });
});


function bloquearEspacio(event) {
    // Obtenemos el elemento actual
    const element = event.target;

    // Lista de IDs de los campos donde se debe bloquear la barra espaciadora
    const camposBloqueados = [
        'DNI',
        'UsuarioOneTouch',
        'RUTCliente',
        'Movil1',
        'Movil2',
        'NumNegocio'
    ];

    // Si el campo actual está en la lista de campos bloqueados
    if (camposBloqueados.includes(element.id)) {
        // Si la tecla presionada es la barra espaciadora (código de la barra espaciadora es 32)
        if (event.keyCode === 32) {
            event.preventDefault(); // Prevenir el espacio
        }
    }
}

// Función para bloquear el pegado de espacio
function bloquearPegarEspacio(event) {
    const element = event.target;

    // Lista de IDs de los campos donde se debe bloquear el espacio en el pegado
    const camposBloqueados = [
        'DNI',
        'UsuarioOneTouch',
        'RUTCliente',
        'Movil1',
        'Movil2',
        'NumNegocio'
    ];

    // Comprobamos si el campo actual está en la lista de campos bloqueados
    if (camposBloqueados.includes(element.id)) {
        // Obtener el texto pegado (para pegar no solo una tecla sino cualquier cosa)
        const textoPegar = event.clipboardData.getData('text');

        // Si el texto contiene un espacio, prevenir el pegado
        if (textoPegar.includes(' ')) {
            event.preventDefault(); // Prevenir el pegado de espacio
        }
    }
}

// Añadir el event listener para la tecla de espacio en los campos especificados
document.getElementById("DNI").addEventListener("keydown", bloquearEspacio);
document.getElementById("UsuarioOneTouch").addEventListener("keydown", bloquearEspacio);
document.getElementById("RUTCliente").addEventListener("keydown", bloquearEspacio);
document.getElementById("Movil1").addEventListener("keydown", bloquearEspacio);
document.getElementById("Movil2").addEventListener("keydown", bloquearEspacio);
document.getElementById("NumNegocio").addEventListener("keydown", bloquearEspacio);

// Añadir el event listener para el pegado de texto (paste) en los campos especificados
document.getElementById("DNI").addEventListener("paste", bloquearPegarEspacio);
document.getElementById("UsuarioOneTouch").addEventListener("paste", bloquearPegarEspacio);
document.getElementById("RUTCliente").addEventListener("paste", bloquearPegarEspacio);
document.getElementById("Movil1").addEventListener("paste", bloquearPegarEspacio);
document.getElementById("Movil2").addEventListener("paste", bloquearPegarEspacio);
document.getElementById("NumNegocio").addEventListener("paste", bloquearPegarEspacio);



function bloquearCaracteres(event) {
    const element = event.target;

    // Lista de IDs de los campos donde se debe bloquear la barra espaciadora, coma y punto y coma
    const camposBloqueados = [
        'DNI',
        'UsuarioOneTouch',
        'RUTCliente',
        'Movil1',
        'Movil2',
        'NumNegocio',
        'NombreEjecutivo',
        'NombreCliente',
        'DireccionCliente'
    ];

    // Comprobamos si el campo actual está en la lista de campos bloqueados
    if (camposBloqueados.includes(element.id)) {
        // Bloquear la tecla de la coma (,) y el punto y coma (;)
        if (event.keyCode === 188 || event.keyCode === 186) {
            event.preventDefault(); // Prevenir la acción predeterminada
        }
    }
}

// Función para bloquear el pegado de coma y punto y coma
function bloquearPegar(event) {
    const element = event.target;

    // Lista de IDs de los campos donde se debe bloquear la coma y punto y coma en el pegado
    const camposBloqueados = [
        'DNI',
        'UsuarioOneTouch',
        'RUTCliente',
        'Movil1',
        'Movil2',
        'NumNegocio',
        'NombreEjecutivo',
        'NombreCliente',
        'DireccionCliente'
    ];

    // Comprobamos si el campo actual está en la lista de campos bloqueados
    if (camposBloqueados.includes(element.id)) {
        // Obtener el texto pegado (para pegar no solo una tecla sino cualquier cosa)
        const textoPegar = event.clipboardData.getData('text');

        // Si el texto contiene coma (,) o punto y coma (;), prevenir el pegado
        if (textoPegar.includes(',') || textoPegar.includes(';')) {
            event.preventDefault(); // Prevenir el pegado
        }
    }
}

// Añadir el event listener a los campos especificados
document.getElementById("DNI").addEventListener("keydown", bloquearCaracteres);
document.getElementById("UsuarioOneTouch").addEventListener("keydown", bloquearCaracteres);
document.getElementById("RUTCliente").addEventListener("keydown", bloquearCaracteres);
document.getElementById("Movil1").addEventListener("keydown", bloquearCaracteres);
document.getElementById("Movil2").addEventListener("keydown", bloquearCaracteres);
document.getElementById("NumNegocio").addEventListener("keydown", bloquearCaracteres);
document.getElementById("NombreEjecutivo").addEventListener("keydown", bloquearCaracteres);
document.getElementById("NombreCliente").addEventListener("keydown", bloquearCaracteres);
document.getElementById("DireccionCliente").addEventListener("keydown", bloquearCaracteres);

// Añadir el event listener para el pegado de texto
document.getElementById("DNI").addEventListener("paste", bloquearPegar);
document.getElementById("UsuarioOneTouch").addEventListener("paste", bloquearPegar);
document.getElementById("RUTCliente").addEventListener("paste", bloquearPegar);
document.getElementById("Movil1").addEventListener("paste", bloquearPegar);
document.getElementById("Movil2").addEventListener("paste", bloquearPegar);
document.getElementById("NumNegocio").addEventListener("paste", bloquearPegar);
document.getElementById("NombreEjecutivo").addEventListener("paste", bloquearPegar);
document.getElementById("NombreCliente").addEventListener("paste", bloquearPegar);
document.getElementById("DireccionCliente").addEventListener("paste", bloquearPegar);



function bloquearCaracteresNoNumericos(event) {
    const element = event.target;

    // Lista de IDs de los campos donde solo se deben permitir números
    const camposPermitidos = [
        'DNI',
        'NumNegocio',
        'Movil1',
        'Movil2'
    ];

    // Comprobamos si el campo actual está en la lista de campos permitidos
    if (camposPermitidos.includes(element.id)) {
        // Obtenemos el código de la tecla presionada
        const keyCode = event.keyCode || event.which;

        // Permitir solo números (48-57) y (96-105 para el teclado numérico)
        // También permitir la tecla Backspace (keyCode 8)
        const esNumero = (keyCode >= 48 && keyCode <= 57) || (keyCode >= 96 && keyCode <= 105);
        const esBackspace = keyCode === 8; // Código para la tecla Backspace

        // Si no es un número ni Backspace, prevenimos el evento (bloqueamos la tecla)
        if (!esNumero && !esBackspace) {
            event.preventDefault(); // Bloquear la tecla
        }
    }
}

// Añadir el event listener a los campos especificados para bloquear caracteres no numéricos
document.getElementById("DNI").addEventListener("keydown", bloquearCaracteresNoNumericos);
document.getElementById("NumNegocio").addEventListener("keydown", bloquearCaracteresNoNumericos);
document.getElementById("Movil1").addEventListener("keydown", bloquearCaracteresNoNumericos);
document.getElementById("Movil2").addEventListener("keydown", bloquearCaracteresNoNumericos);


</script>
</body>
</html>
0
